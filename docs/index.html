<!DOCTYPE html>
<html>
<head>
    <title>Food Ingredient Detector</title>
</head>
<body>

<h1>Food Ingredient Detector</h1>

<div>
    <label for="backendUrl">Backend URL (full endpoint, e.g., https://your-host/analyze):</label><br>
    <input type="text" id="backendUrl" size="60" placeholder="https://your-backend-host/analyze">
    <button onclick="saveBackendUrl()">Save backend URL</button>
    <small>Saved in your browser for reuse.</small>
    <br><br>
</div>

<h2>Upload food image</h2>

<input type="file" id="img" accept="image/*">
<button onclick="analyzeImage()">Analyze</button>

<h3>Result:</h3>
<pre id="result"></pre>

<script>
const backendInput = document.getElementById("backendUrl");
const savedBackend = localStorage.getItem("backendUrl");
if (savedBackend) {
    backendInput.value = savedBackend;
}

function saveBackendUrl() {
    const url = backendInput.value.trim();
    if (!url) {
        alert("Please enter a backend URL.");
        return;
    }
    localStorage.setItem("backendUrl", url);
    alert("Backend URL saved.");
}

async function analyzeImage() {
    const backendUrl = backendInput.value.trim();
    if (!backendUrl) {
        alert("Set the backend URL first.");
        return;
    }

    const file = document.getElementById("img").files[0];
    if (!file) {
        alert("Please choose an image.");
        return;
    }

    const formData = new FormData();
    formData.append("image", file);

    const res = await fetch(backendUrl, {
        method: "POST",
        body: formData
    });

    const data = await res.json();
    document.getElementById("result").innerText =
        JSON.stringify(data, null, 2);
}
</script>

</body>
</html>
